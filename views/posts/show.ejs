<%- include("../partials/header") %>
<div class="container post-container w-75 p-3 border rounded">
  <div class="container title-container">
    <h1><%= post.title %></h1>
    <p>
      By
      <a href="/users/<%= post.user._id %>"
        ><span class="font-weight-bold"><%= post.user.username %></span></a
      >
      on
      <span><%= post.date%></span>
    </p>
  </div>
  <div class="image-container">
    <img src="/<%= post.image %>" class="post-image" />
    <p id="image-caption"><%= post.caption%></p>
    <% if (currentUser && currentUser._id.equals(post.user._id)) { %>
    <a href="/posts/<%= post._id%>/edit"
      ><button class="btn btn-outline-warning">Edit</button></a
    >
    <form action="/posts/<%= post._id%>?_method=DELETE" method="POST">
      <button class="btn btn-outline-danger">Delete</button>
    </form>
    <% } %>
  </div>
  <!-- Comment Section -->
  <div class="comments-section">
    <% for (let i = 0; i < post.comments.length; i++) { %>
    <p>
      <span class="font-weight-bold"
        ><%= post.comments[i].user.username %> </span
      ><%= post.comments[i].text %>
    </p>
    <form
      action="/posts/<%= post._id %>/comments/<%= post.comments[i]._id %>?_method=DELETE"
      method="POST"
    >
      <button class="btn btn-outline-danger">Delete</button>
    </form>
    <% } %>
  </div>
  <div>
    <form
      action="/posts/<%= post._id%>/comments"
      method="POST"
      class="comment-form"
    >
      <textarea name="text" placeholder="Leave a Comment"></textarea>
      <button type="submit" class="btn btn-outline-secondary">
        <i class="fa fa-share"></i> Share
      </button>
    </form>
  </div>
</div>

<%- include("../partials/footer") %>
